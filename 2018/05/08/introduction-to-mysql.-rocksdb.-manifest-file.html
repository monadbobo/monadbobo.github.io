<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>MySQL · RocksDB · MANIFEST文件介绍 | pagefault</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">MySQL · RocksDB · MANIFEST文件介绍</h1><a id="logo" href="/.">pagefault</a><p class="description">但行好事 莫問前程</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">MySQL · RocksDB · MANIFEST文件介绍</h1><div class="post-meta">May 8, 2018</div><div class="post-content"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>在RocksDB中MANIFEST保存了存储引擎的内部的一些状态元数据，简单来说当系统异常重启，或者程序异常被退出之后，RocksDB需要有一种机制能够恢复到一个一致性的状态，<br>而这个一致性的状态就是靠MANIFEST来保证的.</p>
<p>MANIFEST在RocksDB中是一个单独的文件，而这个文件所保存的数据基本是来自于VersionEdit这个结构.</p>
<p>MANIFEST包含了两个文件，一个log文件一个包含最新MANIFEST文件名的文件，Manifest的log文件名是这样 MANIFEST-(seqnumber),这个seq会一直增长.只有当<br>超过了指定的大小之后，MANIFEST会刷新一个新的文件,当新的文件刷新到磁盘(并且文件名更新)之后，老的文件会被删除掉.这里可以认为每一次MANIFEST的更新都代表一次snapshot.</p>
<p>下面就是MANIFEST的基本文件组成:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MANIFEST = &#123; CURRENT, MANIFEST-&lt;seq-no&gt;* &#125; </span><br><span class="line">CURRENT = File pointer to the latest manifest log</span><br><span class="line">MANIFEST-&lt;seq no&gt; = Contains snapshot of RocksDB state and subsequent modifications</span><br></pre></td></tr></table></figure>
<p>在RocksDB中任意时间存储引擎的状态都会保存为一个Version(也就是SST的集合)，而每次对Version的修改都是一个VersionEdit,而最终这些VersionEdit就是<br>组成manifest-log文件的内容.</p>
<p>下面就是MANIFEST的log文件的基本构成:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">version-edit      = Any RocksDB state change</span><br><span class="line">version           = &#123; version-edit* &#125;</span><br><span class="line">manifest-log-file = &#123; version, version-edit* &#125;</span><br><span class="line">                  = &#123; version-edit* &#125;</span><br></pre></td></tr></table></figure>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>整个MANIFEST涉及到三个数据结构分别是VersionEdit/Version/VersionSet,其中前两个上面已经有介绍，而最后一个VersionSet顾名思义表示一堆Version的集合，其实就是<br>记录了各个版本的信息用来管理整个Version.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class VersionSet &#123;</span><br><span class="line"> public:</span><br><span class="line">  VersionSet(const std::string&amp; dbname, const ImmutableDBOptions* db_options,</span><br><span class="line">             const EnvOptions&amp; env_options, Cache* table_cache,</span><br><span class="line">             WriteBufferManager* write_buffer_manager,</span><br><span class="line">             WriteController* write_controller);</span><br><span class="line">  ~VersionSet();</span><br><span class="line">.......................</span><br><span class="line"> private:</span><br><span class="line">  struct ManifestWriter;</span><br><span class="line"></span><br><span class="line">  friend class Version;</span><br><span class="line">.................................</span><br><span class="line">  // Opened lazily</span><br><span class="line">  unique_ptr&lt;log::Writer&gt; descriptor_log_;</span><br><span class="line">  // generates a increasing version number for every new version</span><br><span class="line">  uint64_t current_version_number_;</span><br><span class="line"></span><br><span class="line">  // Queue of writers to the manifest file</span><br><span class="line">  std::deque&lt;ManifestWriter*&gt; manifest_writers_;</span><br><span class="line">..........................................</span><br></pre></td></tr></table></figure>
<p>这里最关键的两个数据结构是descriptor_log_和manifest_writers_,前一个表示了当前manifest-log文件，后一个表示需要写入到manifest-log文件中的内容.</p>
<p>下面就是ManifestWriter的结构，可以看到其中包含了一个VersionEdit的数组，这个数组就是即将要写入到manifest-log文件中的内容.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// this is used to batch writes to the manifest file</span><br><span class="line">struct VersionSet::ManifestWriter &#123;</span><br><span class="line">  Status status;</span><br><span class="line">  bool done;</span><br><span class="line">  InstrumentedCondVar cv;</span><br><span class="line">  ColumnFamilyData* cfd;</span><br><span class="line">  const autovector&lt;VersionEdit*&gt;&amp; edit_list;</span><br><span class="line"></span><br><span class="line">  explicit ManifestWriter(InstrumentedMutex* mu, ColumnFamilyData* _cfd,</span><br><span class="line">                          const autovector&lt;VersionEdit*&gt;&amp; e)</span><br><span class="line">      : done(false), cv(mu), cfd(_cfd), edit_list(e) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后我们来看RocksDB如何来创建以及写入文件,下面所有的代码都是包含在VersionSet::LogAndApply这个函数中.</p>
<p>首先在每次LogAndApply的时候都会创建一个新的ManifesWriter加入到manifest_writers_队列中.这里只有当之前保存在队列中<br>的所有Writer都写入完毕之后才会加入到队列，否则就会等待.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// queue our request</span><br><span class="line">ManifestWriter w(mu, column_family_data, edit_list);</span><br><span class="line">manifest_writers_.push_back(&amp;w);</span><br><span class="line">while (!w.done &amp;&amp; &amp;w != manifest_writers_.front()) &#123;</span><br><span class="line">  w.cv.Wait();</span><br><span class="line">&#125;</span><br><span class="line">if (w.done) &#123;</span><br><span class="line">  return w.status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来就是保存对应的数据到batch_edits中(manifest_writers_).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">autovector&lt;VersionEdit*&gt; batch_edits;</span><br><span class="line">....................................</span><br><span class="line"> if (w.edit_list.front()-&gt;IsColumnFamilyManipulation()) &#123;</span><br><span class="line">    // no group commits for column family add or drop</span><br><span class="line">    LogAndApplyCFHelper(w.edit_list.front());</span><br><span class="line">    batch_edits.push_back(w.edit_list.front());</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    v = new Version(column_family_data, this, current_version_number_++);</span><br><span class="line">........................................................</span><br><span class="line">    for (const auto&amp; writer : manifest_writers_) &#123;</span><br><span class="line">      if (writer-&gt;edit_list.front()-&gt;IsColumnFamilyManipulation() ||</span><br><span class="line">          writer-&gt;cfd-&gt;GetID() != column_family_data-&gt;GetID()) &#123;</span><br><span class="line">        break;</span><br><span class="line">      &#125;</span><br><span class="line">      last_writer = writer;</span><br><span class="line">      for (const auto&amp; edit : writer-&gt;edit_list) &#123;</span><br><span class="line">...........................................</span><br><span class="line">        batch_edits.push_back(edit);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    builder-&gt;SaveTo(v-&gt;storage_info());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>然后就是创建新的manifest-log文件的逻辑.这里可以看到要么是第一次进入，要么文件大小大于option对应的值才会创建新的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">if (!descriptor_log_ ||</span><br><span class="line">      manifest_file_size_ &gt; db_options_-&gt;max_manifest_file_size) &#123;</span><br><span class="line">    pending_manifest_file_number_ = NewFileNumber();</span><br><span class="line">    batch_edits.back()-&gt;SetNextFile(next_file_number_.load());</span><br><span class="line">    new_descriptor_log = true;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    pending_manifest_file_number_ = manifest_file_number_;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (new_descriptor_log) &#123;</span><br><span class="line">    // if we&apos;re writing out new snapshot make sure to persist max column family</span><br><span class="line">    if (column_family_set_-&gt;GetMaxColumnFamily() &gt; 0) &#123;</span><br><span class="line">      w.edit_list.front()-&gt;SetMaxColumnFamily(</span><br><span class="line">          column_family_set_-&gt;GetMaxColumnFamily());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>如果需要创建新的manifest-log文件，则开始构造对应的文件信息并创建文件.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">if (new_descriptor_log) &#123;</span><br><span class="line">      // create manifest file</span><br><span class="line">      ROCKS_LOG_INFO(db_options_-&gt;info_log, &quot;Creating manifest %&quot; PRIu64 &quot;\n&quot;,</span><br><span class="line">                     pending_manifest_file_number_);</span><br><span class="line">      unique_ptr&lt;WritableFile&gt; descriptor_file;</span><br><span class="line">      EnvOptions opt_env_opts = env_-&gt;OptimizeForManifestWrite(env_options_);</span><br><span class="line">      s = NewWritableFile(</span><br><span class="line">          env_, DescriptorFileName(dbname_, pending_manifest_file_number_),</span><br><span class="line">          &amp;descriptor_file, opt_env_opts);</span><br><span class="line">      if (s.ok()) &#123;</span><br><span class="line">        descriptor_file-&gt;SetPreallocationBlockSize(</span><br><span class="line">            db_options_-&gt;manifest_preallocation_size);</span><br><span class="line"></span><br><span class="line">        unique_ptr&lt;WritableFileWriter&gt; file_writer(</span><br><span class="line">            new WritableFileWriter(std::move(descriptor_file), opt_env_opts));</span><br><span class="line">        descriptor_log_.reset(</span><br><span class="line">            new log::Writer(std::move(file_writer), 0, false));</span><br><span class="line">        s = WriteSnapshot(descriptor_log_.get());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>开始写入对应的VersionEdit的record到文件(最后我们会来看这个record的构成),这里看到写入完成后会调用Sync来刷新内容到磁盘,等这些操作都做完之后，则会更新Current文件也就是更新最新的manifest-log文件名到CURRENT文件中.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">      for (auto&amp; e : batch_edits) &#123;</span><br><span class="line">        std::string record;</span><br><span class="line">        if (!e-&gt;EncodeTo(&amp;record)) &#123;</span><br><span class="line">          s = Status::Corruption(</span><br><span class="line">              &quot;Unable to Encode VersionEdit:&quot; + e-&gt;DebugString(true));</span><br><span class="line">          break;</span><br><span class="line">        &#125;</span><br><span class="line">        TEST_KILL_RANDOM(&quot;VersionSet::LogAndApply:BeforeAddRecord&quot;,</span><br><span class="line">                         rocksdb_kill_odds * REDUCE_ODDS2);</span><br><span class="line">        s = descriptor_log_-&gt;AddRecord(record);</span><br><span class="line">        if (!s.ok()) &#123;</span><br><span class="line">          break;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      if (s.ok()) &#123;</span><br><span class="line">        s = SyncManifest(env_, db_options_, descriptor_log_-&gt;file());</span><br><span class="line">      &#125;</span><br><span class="line">.............................</span><br><span class="line">    // If we just created a new descriptor file, install it by writing a</span><br><span class="line">    // new CURRENT file that points to it.</span><br><span class="line">    if (s.ok() &amp;&amp; new_descriptor_log) &#123;</span><br><span class="line">      s = SetCurrentFile(env_, dbname_, pending_manifest_file_number_,</span><br><span class="line">                         db_directory);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>CURRENT文件更新完毕之后，就可以删除老的mainfest文件了.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Append the old mainfest file to the obsolete_manifests_ list to be deleted</span><br><span class="line">// by PurgeObsoleteFiles later.</span><br><span class="line">if (s.ok() &amp;&amp; new_descriptor_log) &#123;</span><br><span class="line">  obsolete_manifests_.emplace_back(</span><br><span class="line">      DescriptorFileName(&quot;&quot;, manifest_file_number_));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后则是更新manifest_writers_队列，唤醒之前阻塞的内容.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// wake up all the waiting writers</span><br><span class="line">while (true) &#123;</span><br><span class="line">  ManifestWriter* ready = manifest_writers_.front();</span><br><span class="line">  manifest_writers_.pop_front();</span><br><span class="line">  if (ready != &amp;w) &#123;</span><br><span class="line">    ready-&gt;status = s;</span><br><span class="line">    ready-&gt;done = true;</span><br><span class="line">    ready-&gt;cv.Signal();</span><br><span class="line">  &#125;</span><br><span class="line">  if (ready == last_writer) break;</span><br><span class="line">&#125;</span><br><span class="line">// Notify new head of write queue</span><br><span class="line">if (!manifest_writers_.empty()) &#123;</span><br><span class="line">  manifest_writers_.front()-&gt;cv.Signal();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h2><p>具体的文件格式可以看<a href="https://github.com/facebook/rocksdb/wiki/MANIFEST#version-edit-layout" target="_blank" rel="noopener">RocksDB</a>的wiki,这里我来介绍下对应的源码.<br>通过上面的分析我们可以看到最终是通过VersionEdit::EncodeTo来序列化数据,而VersionEdit主要包含了比如log_number/last_sequence_这些字段，这里还有一个比较关键的信息被序列化了，那就是FileMetaData,也就是SST文件的元信息.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">struct FileMetaData &#123;</span><br><span class="line">  FileDescriptor fd;</span><br><span class="line">  InternalKey smallest;            // Smallest internal key served by table</span><br><span class="line">  InternalKey largest;             // Largest internal key served by table</span><br><span class="line">  SequenceNumber smallest_seqno;   // The smallest seqno in this file</span><br><span class="line">  SequenceNumber largest_seqno;    // The largest seqno in this file</span><br><span class="line"></span><br><span class="line">.........................................</span><br><span class="line">  // File size compensated by deletion entry.</span><br><span class="line">  // This is updated in Version::UpdateAccumulatedStats() first time when the</span><br><span class="line">  // file is created or loaded.  After it is updated (!= 0), it is immutable.</span><br><span class="line">  uint64_t compensated_file_size;</span><br><span class="line">  // These values can mutate, but they can only be read or written from</span><br><span class="line">  // single-threaded LogAndApply thread</span><br><span class="line">  uint64_t num_entries;            // the number of entries.</span><br><span class="line">  uint64_t num_deletions;          // the number of deletion entries.</span><br><span class="line">  uint64_t raw_key_size;           // total uncompressed key size.</span><br><span class="line">  uint64_t raw_value_size;         // total uncompressed value size.</span><br><span class="line"></span><br><span class="line">  int refs;  // Reference count</span><br><span class="line"></span><br><span class="line">  bool being_compacted;        // Is this file undergoing compaction?</span><br><span class="line">  bool init_stats_from_file;   // true if the data-entry stats of this file</span><br><span class="line">                               // has initialized from file.</span><br><span class="line"></span><br><span class="line">  bool marked_for_compaction;  // True if client asked us nicely to compact this</span><br><span class="line">                               // file.</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>这里查看MANIFEST文件依旧是使用ldb工具:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pagefault@god ~/tools/polarbase/data/.rocksdb $ ../../bin/ldb manifest_dump --path=./MANIFEST-000001</span><br><span class="line">--------------- Column family &quot;default&quot;  (ID 0) --------------</span><br><span class="line">log number: 13</span><br><span class="line">comparator: &lt;NO COMPARATOR&gt;</span><br><span class="line">--- level 0 --- version# 0 ---</span><br><span class="line"> 11:80860[&apos; </span><br><span class="line">--------------- Column family &quot;__system__&quot;  (ID 1) --------------</span><br><span class="line">log number: 24</span><br><span class="line">comparator: RocksDB_SE_v3.10</span><br><span class="line">--- level 0 --- version# 1 ---</span><br><span class="line"> 25:1094[&apos; </span><br><span class="line">next_file_number 27 last_sequence 190  prev_log_number 0 max_column_family 1</span><br></pre></td></tr></table></figure></p>
</div><div class="tags"><a href="/tags/rocksdb/">rocksdb</a></div><div class="post-nav"><a class="pre" href="/2018/06/06/introduction-to-mysql-rocksdb-column-family.html">MySQL · RocksDB · Column Family介绍</a><a class="next" href="/2018/04/18/introduction-to-mysql-rocksdb-wal-(writeaheadlog).html">MySQL · RocksDB · WAL(WriteAheadLog)介绍</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/SPDY/">SPDY</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/SPDY/协议/">协议</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/erlang/">erlang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/erlang/源码阅读/">源码阅读</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/">kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/mac/">mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/server/">server</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/协议/">协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/源码阅读/">源码阅读</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/lua/">lua</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/lua/源码阅读/">源码阅读</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/server/">server</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/server/源码阅读/">源码阅读</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/协议/">协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/语言规范/">语言规范</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/rocksdb/" style="font-size: 15px;">rocksdb</a> <a href="/tags/lua/" style="font-size: 15px;">lua</a> <a href="/tags/kernel/" style="font-size: 15px;">kernel</a> <a href="/tags/tcp-ip/" style="font-size: 15px;">tcp/ip</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/server/" style="font-size: 15px;">server</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/process/" style="font-size: 15px;">process</a> <a href="/tags/qemu/" style="font-size: 15px;">qemu</a> <a href="/tags/aio/" style="font-size: 15px;">aio</a> <a href="/tags/google/" style="font-size: 15px;">google</a> <a href="/tags/协议/" style="font-size: 15px;">协议</a> <a href="/tags/路由/" style="font-size: 15px;">路由</a> <a href="/tags/tcp/" style="font-size: 15px;">tcp</a> <a href="/tags/TFO/" style="font-size: 15px;">TFO</a> <a href="/tags/rfc/" style="font-size: 15px;">rfc</a> <a href="/tags/c/" style="font-size: 15px;">c</a> <a href="/tags/语言规范/" style="font-size: 15px;">语言规范</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/spdy/" style="font-size: 15px;">spdy</a> <a href="/tags/kenel/" style="font-size: 15px;">kenel</a> <a href="/tags/opensource/" style="font-size: 15px;">opensource</a> <a href="/tags/InnoDB/" style="font-size: 15px;">InnoDB</a> <a href="/tags/sever/" style="font-size: 15px;">sever</a> <a href="/tags/rfs/" style="font-size: 15px;">rfs</a> <a href="/tags/fs/" style="font-size: 15px;">fs</a> <a href="/tags/cache/" style="font-size: 15px;">cache</a> <a href="/tags/server，mm/" style="font-size: 15px;">server，mm</a> <a href="/tags/web-server/" style="font-size: 15px;">web server</a> <a href="/tags/tcp-cork/" style="font-size: 15px;">tcp_cork</a> <a href="/tags/服务器设计/" style="font-size: 15px;">服务器设计</a> <a href="/tags/congest/" style="font-size: 15px;">congest</a> <a href="/tags/keepalive/" style="font-size: 15px;">keepalive</a> <a href="/tags/pipeline/" style="font-size: 15px;">pipeline</a> <a href="/tags/epoll/" style="font-size: 15px;">epoll</a> <a href="/tags/erlang/" style="font-size: 15px;">erlang</a> <a href="/tags/mochiweb/" style="font-size: 15px;">mochiweb</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/loadbalance/" style="font-size: 15px;">loadbalance</a> <a href="/tags/glibc/" style="font-size: 15px;">glibc</a> <a href="/tags/systemcall/" style="font-size: 15px;">systemcall</a> <a href="/tags/心情/" style="font-size: 15px;">心情</a> <a href="/tags/gro/" style="font-size: 15px;">gro</a> <a href="/tags/gc/" style="font-size: 15px;">gc</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/17/design-and-implementation-of-linkbuf-in-innodb.html">InnoDB中LinkBuf设计与实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/17/innodb-tablespace-source-code-analysis.html">InnoDB tablespace源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/19/mysql-rocksdb.-data-reading-(ii).html">MySQL · RocksDB · 数据的读取(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/13/mysql-rocksdb.-data-reading-(i).html">MySQL · RocksDB · 数据的读取(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/27/mysql-rocksdb-level-compact-analysis.html">MySQL · RocksDB · Level Compact 分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/07/mysql-rocksdb-memtable-flush-analysis.html">MySQL · RocksDB · Memtable flush分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/08/writing-of-mysql.-rocksdb.-memtable.html">MySQL · RocksDB ·  MemTable的写入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/04/implementation-of-mysql-rocksdb-writing-logic.html">MySQL · RocksDB ·  写入逻辑的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/06/introduction-to-mysql-rocksdb-column-family.html">MySQL · RocksDB · Column Family介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/08/introduction-to-mysql.-rocksdb.-manifest-file.html">MySQL · RocksDB · MANIFEST文件介绍</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">pagefault.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>